# Student Management Backend

A Node.js/Express backend for managing students and users (admin/student roles) with authentication, built with MongoDB.

---
### deployed at https://student-be-0yca.onrender.com/api, api calls can be made to this base url. do not open this directly in browser. 

## Table of Contents

- [Features](#features)
- [Project Structure](#project-structure)
- [Setup & Installation](#setup--installation)
- [Environment Variables](#environment-variables)
- [Running Locally](#running-locally)
- [Deploying to Vercel (Serverless)](#deploying-to-vercel-serverless)
- [API Endpoints](#api-endpoints)
- [Authentication & Authorization](#authentication--authorization)
- [Assumptions](#assumptions)
- [Troubleshooting](#troubleshooting)

---

## Features

- User authentication (JWT-based)
- Admin and student roles
- Student CRUD operations (admin only)
- Students can view and update their own profiles
- Password hashing with bcrypt
- MongoDB database integration
- Automatic default password generation for students created by admin (default password: firstname@123): eg: if name is Utkarsh Sharma, password will be Utkarsh@123


---

## Project Structure

```
.
├── .env
├── .gitignore
├── db.js
├── index.js
├── package.json
├── requests.rest
├── README.md
├── middleware/
│   └── auth.js
├── models/
│   ├── Student.js
│   └── User.js
├── routes/
│   ├── auth.js
│   └── student.js
└── .vercel/
    ├── project.json
    └── README.txt
```

---

## Setup & Installation

1. **Clone the repository:**
   ```sh
   git clone https://github.com/1basilisk/student_BE
   cd student-management/backend
   ```

2. **Install dependencies:**
   ```sh
   npm install
   ```

3. **Configure environment variables:**
   - Copy `.env` and set the following:
     ```
     MONGO_URI=<your-mongodb-uri>
     JWT_SECRET=<your-jwt-secret>
     PORT=5000
     ```

---

## Environment Variables

- `MONGO_URI`: MongoDB connection string.
- `JWT_SECRET`: Secret key for JWT signing.
- `PORT`: Port for local development (default: 5000).

---

## Running Locally

Start the server in development mode:
```sh
npm run dev
```
Or in production mode:
```sh
npm start
```
The API will be available at `http://localhost:5000`.

---


## API Endpoints

### Auth

- `POST /api/auth/signup`  
  Create a new user (admin or student).
  ```json
  {
    "name": "John Doe",
    "email": "john@example.com",
    "password": "password",
    "role": "student" // or "admin"
  }
  ```

- `POST /api/auth/login`  
  Login and receive JWT.
  ```json
  {
    "email": "john@example.com",
    "password": "password"
  }
  ```

- `PUT /api/auth/change-password`  
  Change password (authenticated).
  ```json
  {
    "currentPassword": "oldpass",
    "newPassword": "newpass"
  }
  ```

### Students

- `GET /api/students`  
  Get all students (admin only).

- `POST /api/students`  
  Add a student (admin only).

- `PUT /api/students/:id`  
  Edit a student (admin only).

- `DELETE /api/students/:id`  
  Delete a student (admin only).

- `GET /api/students/me`  
  Get own student profile (student only).

- `PUT /api/students/me`  
  Update own student profile (student only).

**All protected routes require:**
```
Authorization: Bearer <jwt-token>
```

---

## Authentication & Authorization

- JWT is used for authentication.
- `auth` middleware checks for valid JWT.
- `adminOnly` middleware restricts access to admin routes.
- Students can only access their own profile.

---

## Assumptions

- i have hosted this backend at the mentioned url, if you want to run it locally, you will need to generate mongodb connection string and jwt secret.
- jwt secret is used to generate jwt tokens for users, it can be generated by:

```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```
- copy the output in .env


---

## Troubleshooting

- **Environment Variables:**  
  Make sure all required environment variables are set both locally and on Vercel.

- **CORS Issues:**  
  CORS is enabled for all origins by default.

---

## License

MIT

---